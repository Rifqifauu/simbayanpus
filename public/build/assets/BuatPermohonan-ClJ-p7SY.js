import{r as V,f as w,g as U,h as k,c,b as a,w as B,d as y,i as h,v as I,F as S,j as C,k as E,n as L,a as P,l as j,o as f,t as F}from"./app-EjIw6IA4.js";import{A}from"./AppLayout-DPeSRmQm.js";import{S as N}from"./SuccessModal-DmRL_KCq.js";import{E as O}from"./ErrorModal-DAURxi9Q.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={name:"InternshipForm",components:{SuccessModal:N,ErrorModal:O},props:{divisions:{type:Array,required:!0}},layout:A,setup(_){const e={cv:"CV / Daftar Riwayat Hidup",coverLetter:"Surat Pengantar Magang",proposal:"Proposal Magang",guidelines:"Pedoman Magang dari Universitas"},t=V({division:"",isFlexibleDivision:!1,startDate:"",endDate:"",cv:null,coverLetter:null,proposal:null,guidelines:null}),o=w({}),d=w(!1),n=w(""),m=w(!1),D=U(()=>t.division&&t.startDate&&t.endDate&&t.cv&&t.coverLetter&&t.proposal&&t.guidelines&&new Date(t.startDate)<=new Date(t.endDate)),s=r=>l=>{o.value[r]=l},u=r=>{const l=r.target.files[0],g=r.target.dataset.key;if(l){const v=[".pdf",".doc",".docx"],b="."+l.name.split(".").pop().toLowerCase();if(!v.includes(b)){n.value="Format file tidak valid. Gunakan PDF, DOC, atau DOCX.",d.value=!0,r.target.value="";return}if(l.size>2*1024*1024){n.value="Ukuran file maksimal 2MB",d.value=!0,r.target.value="";return}t[g]=l}},p=r=>{const l=o.value[r];l&&l.click()},T=()=>{if(!t.division)return n.value="Silakan pilih divisi",d.value=!0,!1;if(!t.startDate||!t.endDate)return n.value="Periode magang wajib diisi",d.value=!0,!1;if(new Date(t.startDate)>new Date(t.endDate))return n.value="Tanggal mulai tidak boleh lebih besar dari tanggal selesai",d.value=!0,!1;const r=["cv","coverLetter","proposal","guidelines"];for(const l of r)if(!t[l])return n.value=`${e[l]} wajib diupload`,d.value=!0,!1;return!0};return{fileUploadFields:e,formData:t,fileInputs:o,showErrorModal:d,errorMessage:n,showSuccessModal:m,isFormValid:D,setFileInputReference:s,handleFileUpload:u,triggerFileInput:p,submitForm:async()=>{var r,l,g,v,b,M;try{if(!T())return;const i=new FormData;i.append("division",t.division),i.append("isFlexibleDivision",t.isFlexibleDivision),i.append("startDate",t.startDate),i.append("endDate",t.endDate),Object.keys(e).forEach(x=>{t[x]&&i.append(x,t[x])}),(await j.post("/permohonan/create",i,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(m.value=!0,setTimeout(()=>{document.location.href="/permohonan"},2e3))}catch(i){console.error("Error submitting form:",i),(l=(r=i.response)==null?void 0:r.data)!=null&&l.message?n.value=i.response.data.message:(M=(b=(v=(g=i.response)==null?void 0:g.data)==null?void 0:v.errors)==null?void 0:b.email)!=null&&M[0]?n.value=i.response.data.errors.email[0]:n.value="Terjadi kesalahan. Silakan coba lagi.",d.value=!0,setTimeout(()=>{d.value=!1},2e3)}}}}},z={class:"min-h-screen bg-gray-100 py-6 px-4 sm:px-6 lg:px-8"},G={class:"max-w-2xl mx-auto"},H={class:"bg-red-600 rounded-lg shadow-lg p-6 text-white"},X=["value"],J={class:"grid grid-cols-2 gap-4"},K={class:"block text-yellow-300 mb-2"},Q={class:"flex items-center space-x-2"},W=["data-key"],Y=["onClick"],Z={class:"text-sm"},$=["disabled"];function ee(_,e,t,o,d,n){const m=k("ErrorModal"),D=k("SuccessModal");return f(),c("div",z,[a("div",G,[e[12]||(e[12]=a("div",{class:"text-center mb-8"},[a("h1",{class:"text-3xl font-bold text-red-600"},"Daftar Magang"),a("p",{class:"text-gray-600"},"Isi data diri Anda di bawah ini!")],-1)),a("div",H,[a("form",{onSubmit:e[4]||(e[4]=B((...s)=>o.submitForm&&o.submitForm(...s),["prevent"])),class:"space-y-6"},[a("div",null,[e[8]||(e[8]=a("label",{class:"block text-yellow-300 mb-2"},[y("Divisi "),a("span",{class:"text-yellow-200"},"*")],-1)),h(a("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.formData.division=s),class:"w-full px-3 py-2 rounded-md text-gray-700 focus:outline-none focus:ring-2 focus:ring-yellow-300"},[e[7]||(e[7]=a("option",{value:"",disabled:""},"Pilih...",-1)),(f(!0),c(S,null,C(t.divisions,s=>(f(),c("option",{key:s.id,value:s.nama_divisi},F(s.nama_divisi),9,X))),128))],512),[[I,o.formData.division]])]),a("div",J,[a("div",null,[e[9]||(e[9]=a("label",{class:"block text-yellow-300 mb-2"},[y("Periode Mulai "),a("span",{class:"text-yellow-200"},"*")],-1)),h(a("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>o.formData.startDate=s),class:"w-full px-3 py-2 rounded-md text-gray-700 focus:outline-none focus:ring-2 focus:ring-yellow-300"},null,512),[[E,o.formData.startDate]])]),a("div",null,[e[10]||(e[10]=a("label",{class:"block text-yellow-300 mb-2"},[y("Periode Berakhir "),a("span",{class:"text-yellow-200"},"*")],-1)),h(a("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>o.formData.endDate=s),class:"w-full px-3 py-2 rounded-md text-gray-700 focus:outline-none focus:ring-2 focus:ring-yellow-300"},null,512),[[E,o.formData.endDate]])])]),(f(!0),c(S,null,C(o.fileUploadFields,(s,u)=>(f(),c("div",{key:u},[a("label",K,[y(F(s)+" ",1),e[11]||(e[11]=a("span",{class:"text-yellow-200"},"*",-1))]),a("div",Q,[a("input",{type:"file",ref_for:!0,ref:o.setFileInputReference(u),"data-key":u,onChange:e[3]||(e[3]=p=>o.handleFileUpload(p)),class:"hidden",accept:".pdf,.doc,.docx"},null,40,W),a("button",{type:"button",onClick:p=>o.triggerFileInput(u),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300"}," Pilih File ",8,Y),a("span",Z,F(o.formData[u]?o.formData[u].name:"Tidak ada file yang dipilih."),1)])]))),128)),a("button",{type:"submit",disabled:!o.isFormValid,class:L(["w-full py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-300",o.isFormValid?"bg-yellow-400 hover:bg-yellow-500":"bg-gray-400 cursor-not-allowed"])}," Daftar ",10,$)],32)])]),P(m,{show:o.showErrorModal,message:o.errorMessage,title:"Pendaftaran Gagal",onClose:e[5]||(e[5]=s=>o.showErrorModal=!1)},null,8,["show","message"]),P(D,{show:o.showSuccessModal,title:"Pendaftaran Berhasil",onClose:e[6]||(e[6]=s=>o.showSuccessModal=!1)},null,8,["show"])])}const ne=R(q,[["render",ee]]);export{ne as default};
